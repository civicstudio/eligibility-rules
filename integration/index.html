---
layout: default
title: "Integration"
---

<div class="bg-white min-h-screen">
  {% include nav.html %}

  <main class="mx-auto max-w-7xl px-6 py-12">
    <div class="mb-12">
      <h1 class="text-4xl font-bold text-gray-900">Integration</h1>
      <p class="mt-4 text-lg text-gray-600 max-w-3xl">
        How eligibility rules flow from policy to code, and how to integrate structured rulesets into your systems.
      </p>
    </div>

    <!-- Part A: How It Works -->
    <section class="mb-20">
      <h2 class="text-2xl font-bold text-gray-900 mb-8">How Eligibility Determination Works</h2>

      <div class="rounded-2xl border border-gray-200 p-8 mb-8">
        <div class="grid gap-8 md:grid-cols-3">
          <!-- Step 1: User Attributes -->
          <div class="text-center">
            <div class="mx-auto flex size-16 items-center justify-center rounded-full bg-primary-100 mb-4">
              <svg
                class="size-8 text-primary-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
                />
              </svg>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2">User Attributes</h3>
            <p class="text-sm text-gray-600">
              A person's circumstances expressed as key/value pairs: income, age, household size, residency, etc.
            </p>
            <div class="mt-4 rounded-lg bg-gray-50 p-3 text-left">
              <code class="text-xs text-gray-700">
                {<br>
                &nbsp;&nbsp;"household_income": 2400,<br>
                &nbsp;&nbsp;"household_size": 3,<br>
                &nbsp;&nbsp;"age": 34,<br>
                &nbsp;&nbsp;"residency": "CA"<br>
                }
              </code>
            </div>
          </div>

          <!-- Arrow -->
          <div class="hidden md:flex items-center justify-center">
            <div class="flex flex-col items-center">
              <svg
                class="size-8 text-gray-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 4.5v15m0 0l6.75-6.75M12 19.5l-6.75-6.75"
                />
              </svg>
              <div class="my-4 rounded-xl bg-gray-900 px-4 py-3 text-center">
                <div class="text-xs text-gray-400 uppercase tracking-wide">Rules Engine</div>
                <div class="text-sm font-medium text-white mt-1">validate(ruleset, attributes)</div>
              </div>
              <svg
                class="size-8 text-gray-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 4.5v15m0 0l6.75-6.75M12 19.5l-6.75-6.75"
                />
              </svg>
            </div>
          </div>

          <!-- Step 3: Determination -->
          <div class="text-center">
            <div class="mx-auto flex size-16 items-center justify-center rounded-full bg-green-100 mb-4">
              <svg
                class="size-8 text-green-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
            </div>
            <h3 class="font-semibold text-gray-900 mb-2">Determination</h3>
            <p class="text-sm text-gray-600">
              A clear, consistent, calculable result: eligible or not, with detailed validation messages.
            </p>
            <div class="mt-4 rounded-lg bg-gray-50 p-3 text-left">
              <code class="text-xs text-gray-700">
                {<br>
                &nbsp;&nbsp;"eligible": true,<br>
                &nbsp;&nbsp;"passed": ["income", "age"],<br>
                &nbsp;&nbsp;"failed": [],<br>
                &nbsp;&nbsp;"messages": [...]<br>
                }
              </code>
            </div>
          </div>
        </div>

        <!-- Mobile arrows -->
        <div class="md:hidden flex justify-center my-6">
          <div class="rounded-xl bg-gray-900 px-4 py-3 text-center">
            <div class="text-xs text-gray-400 uppercase tracking-wide">Rules Engine</div>
            <div class="text-sm font-medium text-white mt-1">validate(ruleset, attributes)</div>
          </div>
        </div>
      </div>

      <div class="prose prose-gray max-w-none">
        <p>
          The rules engine is a pure function: given a person's attributes and a program's ruleset, it returns a determination. The same inputs always produce the same outputs. This makes eligibility <strong>calculable</strong>, <strong>testable</strong>, and <strong>auditable</strong>.
        </p>
        <p>
          Each rule in a ruleset maps to a specific attribute key. The engine evaluates each condition and returns which rules passed, which failed, and which were skipped (due to missing data or conditional logic).
        </p>
      </div>
    </section>

    <!-- Part B: From Policy to Code -->
    <section class="mb-20">
      <h2 class="text-2xl font-bold text-gray-900 mb-8">From Policy to Code</h2>

      <p class="text-gray-600 mb-8 max-w-3xl">
        Eligibility rules originate in legislation, regulation, and policy documents. The path to implementation often looks like this:
      </p>

      <div class="relative">
        <!-- Timeline -->
        <div class="absolute left-8 top-0 bottom-0 w-0.5 bg-gray-200 md:left-1/2 md:-ml-px"></div>

        <div class="space-y-12">
          <!-- Step 1: Legislation/Policy -->
          <div class="relative flex items-start md:justify-center">
            <div class="flex md:w-1/2 md:pr-8 md:justify-end">
              <div class="ml-16 md:ml-0 rounded-xl border border-gray-200 p-6 max-w-md">
                <div class="absolute left-6 md:left-1/2 md:-ml-3 flex size-6 items-center justify-center rounded-full bg-primary-600 text-white text-xs font-bold">1</div>
                <h3 class="font-semibold text-gray-900 mb-2">Legislation & Policy</h3>
                <p class="text-sm text-gray-600">
                  Laws and regulations define who qualifies for a program. These documents contain the authoritative eligibility criteria, often in legal language.
                </p>
                <div class="mt-3 text-xs text-gray-500 italic">
                  "...households with gross income at or below 130 percent of the poverty line..."
                </div>
              </div>
            </div>
          </div>

          <!-- Step 2: Agency Interpretation -->
          <div class="relative flex items-start md:justify-center">
            <div class="md:w-1/2 md:pl-8 md:ml-auto">
              <div class="ml-16 md:ml-0 rounded-xl border border-gray-200 p-6 max-w-md">
                <div class="absolute left-6 md:left-1/2 md:-ml-3 flex size-6 items-center justify-center rounded-full bg-primary-600 text-white text-xs font-bold">2</div>
                <h3 class="font-semibold text-gray-900 mb-2">Agency Interpretation</h3>
                <p class="text-sm text-gray-600">
                  Agencies publish guidance, handbooks, and FAQs that clarify how rules apply. This is where edge cases and exceptions get documented.
                </p>
              </div>
            </div>
          </div>

          <!-- Step 3: Structured Encoding -->
          <div class="relative flex items-start md:justify-center">
            <div class="flex md:w-1/2 md:pr-8 md:justify-end">
              <div class="ml-16 md:ml-0 rounded-xl border border-gray-200 p-6 max-w-md">
                <div class="absolute left-6 md:left-1/2 md:-ml-3 flex size-6 items-center justify-center rounded-full bg-primary-600 text-white text-xs font-bold">3</div>
                <h3 class="font-semibold text-gray-900 mb-2">Structured Encoding</h3>
                <p class="text-sm text-gray-600">
                  Rules are distilled into machine-readable YAML with clear operators, values, and source citations. Each condition becomes testable.
                </p>
                <div class="mt-3 rounded bg-gray-900 p-2">
                  <code class="text-xs text-gray-300">
                    operator: less_than_or_equal<br>
                    value: 130<br>
                    unit: percent_fpl
                  </code>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 4: Software Integration -->
          <div class="relative flex items-start md:justify-center">
            <div class="md:w-1/2 md:pl-8 md:ml-auto">
              <div class="ml-16 md:ml-0 rounded-xl border border-gray-200 p-6 max-w-md">
                <div class="absolute left-6 md:left-1/2 md:-ml-3 flex size-6 items-center justify-center rounded-full bg-primary-600 text-white text-xs font-bold">4</div>
                <h3 class="font-semibold text-gray-900 mb-2">Software Integration</h3>
                <p class="text-sm text-gray-600">
                  Applications consume the ruleset via API or direct import. The rules engine evaluates user data against the current ruleset version.
                </p>
              </div>
            </div>
          </div>

          <!-- Step 5: Version & Update -->
          <div class="relative flex items-start md:justify-center">
            <div class="flex md:w-1/2 md:pr-8 md:justify-end">
              <div class="ml-16 md:ml-0 rounded-xl border border-gray-200 p-6 max-w-md">
                <div class="absolute left-6 md:left-1/2 md:-ml-3 flex size-6 items-center justify-center rounded-full bg-primary-600 text-white text-xs font-bold">5</div>
                <h3 class="font-semibold text-gray-900 mb-2">Version & Update</h3>
                <p class="text-sm text-gray-600">
                  When policy changes, the ruleset is updated via pull request. Git history provides full audit trail. Downstream systems pull the new version.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- For Agency Staff -->
    <section class="mb-20">
      <h2 class="text-2xl font-bold text-gray-900 mb-8">For Agency Staff & Policy Teams</h2>

      <div class="grid gap-6 md:grid-cols-2">
        <div class="rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold text-gray-900 mb-3">Encoding Existing Programs</h3>
          <p class="text-sm text-gray-600 mb-4">
            Your program's eligibility rules likely already exist in handbooks, policy documents, or legacy systems. These can be reliably distilled into structured rulesets.
          </p>
          <p class="text-sm text-gray-600">
            Start with your program's eligibility page or handbook. Identify each discrete condition (income limits, age ranges, residency requirements). Map each to a rule with a clear operator and value.
          </p>
        </div>

        <div class="rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold text-gray-900 mb-3">Adding New Rules</h3>
          <p class="text-sm text-gray-600 mb-4">
            When policy changes, add or update conditions in the ruleset. Each change is a clear, versioned edit that can be reviewed, tested, and deployed.
          </p>
          <p class="text-sm text-gray-600">
            New rules should include: a unique ID, the attribute key being checked, the operator and value, a human-readable description, and a source URL citing the authoritative policy.
          </p>
        </div>
      </div>
    </section>

    <!-- Distillation Prompt -->
    <section class="mb-20">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Distillation Prompt</h2>
      <p class="text-gray-600 mb-6 max-w-3xl">
        Use this prompt with an LLM to extract eligibility conditions from a program's documentation into a structured ruleset:
      </p>

      <div class="rounded-2xl bg-gray-900 p-6 ring-1 ring-white/10">
        <div class="flex items-center justify-between mb-4">
          <span class="text-xs text-gray-400 uppercase tracking-wide">Prompt Template</span>
          <button
            id="copy-prompt-btn"
            onclick="copyPrompt()"
            class="inline-flex items-center gap-1 text-xs text-gray-400 hover:text-white transition-colors"
          >
            <svg
              class="size-4"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"
              />
            </svg>
            <span id="copy-prompt-text">Copy to clipboard</span>
          </button>
        </div>
        <pre
          id="distillation-prompt"
          class="text-sm text-gray-300 overflow-x-auto whitespace-pre-wrap"
>You are an eligibility rules encoder. Given a program's documentation, extract the eligibility conditions into a structured YAML ruleset.

For each eligibility condition, create a rule with:
- id: A unique snake_case identifier (e.g., "income_gross_limit")
- type: The category (income_fpl, age, residency, citizenship, household, employment, disability, enrollment, assets)
- key: The attribute key to check (e.g., "household_income_fpl_percent")
- operator: One of: equals, not_equals, in, not_in, less_than, less_than_or_equal, greater_than, greater_than_or_equal, between, exists, matches
- value: The threshold or allowed values
- unit: If applicable (percent, dollars, months, years)
- description: A clear, human-readable explanation
- source_url: The URL where this rule is documented

Use these conventions:
- Income as FPL percentage: key ends in "_fpl_percent", value is the percentage (e.g., 130 for 130% FPL)
- Age ranges: use "between" operator with [min, max] array
- Categorical requirements: use "in" operator with array of valid values
- Boolean conditions: use "exists" operator

Output only valid YAML. Include all conditions you can identify, even if some details require assumptions (note assumptions in the description).

---

Program URL: [URL]

Program Documentation:
[PASTE CONTENT HERE]</pre>
      </div>
    </section>

    <!-- Technical Integration -->
    <section class="mb-20">
      <h2 class="text-2xl font-bold text-gray-900 mb-8">Technical Integration</h2>

      <div class="grid gap-6 md:grid-cols-3 mb-12">
        <div class="rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold text-gray-900 mb-3">Direct Import</h3>
          <p class="text-sm text-gray-600 mb-4">
            Clone the repository and import YAML files directly into your application. Parse with any YAML library.
          </p>
          <code class="text-xs bg-gray-100 px-2 py-1 rounded">
            data/jurisdictions/federal/services/snap.yaml
          </code>
        </div>

        <div class="rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold text-gray-900 mb-3">Raw GitHub URLs</h3>
          <p class="text-sm text-gray-600 mb-4">
            Fetch rulesets directly from GitHub's raw content URLs for always-current data.
          </p>
          <code class="text-xs bg-gray-100 px-2 py-1 rounded break-all">
            raw.githubusercontent.com/civicstudio/eligibility-rules/main/data/...
          </code>
        </div>

        <div class="rounded-xl border border-gray-200 p-6">
          <h3 class="font-semibold text-gray-900 mb-3">Rules Engine</h3>
          <p class="text-sm text-gray-600 mb-4">
            Implement the validation function in your language. The engine evaluates user attributes against ruleset conditions.
          </p>
          <code class="text-xs bg-gray-100 px-2 py-1 rounded">
            validate(ruleset, attributes) → result
          </code>
        </div>
      </div>

      <!-- Code Examples -->
      <h3 class="text-xl font-semibold text-gray-900 mb-6">Code Examples</h3>

      <div class="space-y-6">
        <!-- JavaScript Example -->
        <div class="rounded-xl border border-gray-200 overflow-hidden">
          <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <span class="text-yellow-500 font-mono text-sm font-semibold">JS</span>
              <span class="text-sm font-medium text-gray-700">JavaScript / Node.js</span>
            </div>
            <button
              onclick="copyCode('js-code')"
              class="text-xs text-gray-500 hover:text-gray-700 transition-colors"
            >
              Copy
            </button>
          </div>
          <pre
            id="js-code"
            class="p-4 text-sm text-gray-800 overflow-x-auto bg-gray-900"
><code class="text-gray-300">import yaml from 'js-yaml';

// Fetch and parse ruleset
const response = await fetch(
  'https://raw.githubusercontent.com/civicstudio/eligibility-rules/main/data/jurisdictions/federal/services/snap.yaml'
);
const ruleset = yaml.load(await response.text());

// User attributes to validate
const attributes = {
  household_income_fpl_percent: 125,
  household_size: 3,
  residency_state: 'CA',
  citizenship_status: 'us_citizen'
};

// Simple validation function
function validate(ruleset, attributes) {
  const results = { passed: [], failed: [], skipped: [] };

  for (const rule of ruleset.ruleset.rules) {
    const value = attributes[rule.key];
    if (value === undefined) {
      results.skipped.push(rule.id);
      continue;
    }

    const passed = evaluateRule(rule, value);
    (passed ? results.passed : results.failed).push(rule.id);
  }

  results.eligible = results.failed.length === 0;
  return results;
}

const result = validate(ruleset, attributes);
console.log(result); // { eligible: true, passed: [...], failed: [], skipped: [...] }</code></pre>
        </div>

        <!-- Python Example -->
        <div class="rounded-xl border border-gray-200 overflow-hidden">
          <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <span class="text-blue-500 font-mono text-sm font-semibold">PY</span>
              <span class="text-sm font-medium text-gray-700">Python</span>
            </div>
            <button
              onclick="copyCode('py-code')"
              class="text-xs text-gray-500 hover:text-gray-700 transition-colors"
            >
              Copy
            </button>
          </div>
          <pre
            id="py-code"
            class="p-4 text-sm text-gray-800 overflow-x-auto bg-gray-900"
><code class="text-gray-300">import yaml
import requests

# Fetch and parse ruleset
url = "https://raw.githubusercontent.com/civicstudio/eligibility-rules/main/data/jurisdictions/federal/services/snap.yaml"
response = requests.get(url)
ruleset = yaml.safe_load(response.text)

# User attributes to validate
attributes = {
    "household_income_fpl_percent": 125,
    "household_size": 3,
    "residency_state": "CA",
    "citizenship_status": "us_citizen"
}

def validate(ruleset: dict, attributes: dict) -> dict:
    results = {"passed": [], "failed": [], "skipped": []}

    for rule in ruleset["ruleset"]["rules"]:
        value = attributes.get(rule["key"])
        if value is None:
            results["skipped"].append(rule["id"])
            continue

        passed = evaluate_rule(rule, value)
        (results["passed"] if passed else results["failed"]).append(rule["id"])

    results["eligible"] = len(results["failed"]) == 0
    return results

result = validate(ruleset, attributes)
print(result)  # {'eligible': True, 'passed': [...], 'failed': [], 'skipped': [...]}</code></pre>
        </div>

        <!-- Ruby Example -->
        <div class="rounded-xl border border-gray-200 overflow-hidden">
          <div class="bg-gray-50 px-4 py-2 border-b border-gray-200 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <span class="text-red-500 font-mono text-sm font-semibold">RB</span>
              <span class="text-sm font-medium text-gray-700">Ruby</span>
            </div>
            <button
              onclick="copyCode('rb-code')"
              class="text-xs text-gray-500 hover:text-gray-700 transition-colors"
            >
              Copy
            </button>
          </div>
          <pre
            id="rb-code"
            class="p-4 text-sm text-gray-800 overflow-x-auto bg-gray-900"
><code class="text-gray-300">require 'yaml'
require 'net/http'

# Fetch and parse ruleset
uri = URI("https://raw.githubusercontent.com/civicstudio/eligibility-rules/main/data/jurisdictions/federal/services/snap.yaml")
response = Net::HTTP.get(uri)
ruleset = YAML.safe_load(response)

# User attributes to validate
attributes = {
  "household_income_fpl_percent" => 125,
  "household_size" => 3,
  "residency_state" => "CA",
  "citizenship_status" => "us_citizen"
}

def validate(ruleset, attributes)
  results = { passed: [], failed: [], skipped: [] }

  ruleset["ruleset"]["rules"].each do |rule|
    value = attributes[rule["key"]]
    if value.nil?
      results[:skipped] << rule["id"]
      next
    end

    passed = evaluate_rule(rule, value)
    (passed ? results[:passed] : results[:failed]) << rule["id"]
  end

  results[:eligible] = results[:failed].empty?
  results
end

result = validate(ruleset, attributes)
puts result # {:eligible=>true, :passed=>[...], :failed=>[], :skipped=>[...]}</code></pre>
        </div>
      </div>
    </section>

    <script>
      function copyCode(elementId) {
        const code = document.getElementById(elementId).innerText;
        navigator.clipboard.writeText(code).then(() => {
          // Show brief feedback
          const btn = event.target;
          const original = btn.textContent;
          btn.textContent = 'Copied!';
          setTimeout(() => btn.textContent = original, 1500);
        });
      }

      function copyPrompt() {
        const prompt = document.getElementById('distillation-prompt').innerText;
        navigator.clipboard.writeText(prompt).then(() => {
          const textEl = document.getElementById('copy-prompt-text');
          const original = textEl.textContent;
          textEl.textContent = 'Copied!';
          setTimeout(() => textEl.textContent = original, 1500);
        });
      }
    </script>

    <!-- CTA -->
    <section class="rounded-2xl bg-gray-50 p-8 text-center">
      <h2 class="text-2xl font-bold text-gray-900 mb-4">Ready to integrate?</h2>
      <p class="text-gray-600 mb-6 max-w-xl mx-auto">
        Browse existing rulesets, request an encoding for your program, or contribute directly via GitHub.
      </p>
      <div class="flex items-center justify-center gap-4 flex-wrap">
        <a
          href="/browse/"
          class="rounded-md bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500"
        >
          Browse Rules
        </a>
        <a
          href="/contribute/"
          class="rounded-md bg-gray-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-800"
        >
          Request an Encoding
        </a>
        <a
          href="https://github.com/civicstudio/eligibility-rules"
          class="text-sm font-semibold text-gray-900 hover:text-gray-700"
        >
          View on GitHub <span aria-hidden="true">→</span>
        </a>
      </div>
    </section>
  </main>

  {% include footer.html %}
</div>
